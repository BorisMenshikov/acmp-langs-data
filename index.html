<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Статистика популярности языков программирования на acmp.ru</title>
</head>
<body>
<a href="accepted-unique-user-problem-complete-months.png" target="_top" id="chart_link"><img src="accepted-unique-user-problem-complete-months.png" alt="График популярности языков программирования на acmp.ru" style="max-width: 99%" id="chart"></a>
<script>

const RELATIVE = 1;
const ABSOLUTE = 2;
const ABSOLUTE_LOG = 3;

const UNIQUE_USER_PROBLEM = 1;
const ATTEMPTS = 2;
const UNIQUE_USERS = 3;

function getInt123(name, defaultValue) {
    const value = window.localStorage.getItem(name);
    if (value === "1") {
        return 1;
    } else if (value === "2") {
        return 2;
    } else if (value === "3") {
        return 3;
    } else {
        return defaultValue;
    }
}

function setInt(name, value) {
    window.localStorage.setItem(name, value.toString(10));
}

function getBoolean(name, defaultValue) {
    const value = window.localStorage.getItem(name);
    if (value === "1") {
        return true;
    } else if (value === "0") {
        return false;
    } else {
        return defaultValue;
    }
}

function setBoolean(name, value) {
    if (value === true) {
        window.localStorage.setItem(name, "1");
    } else if (value === false) {
        window.localStorage.setItem(name, "0");
    } else {
        throw "неожиданное значение value " + value;
    }
}

var chartType = getInt123("chartType", RELATIVE);
var statType = getInt123("statType", UNIQUE_USER_PROBLEM);
var onlyAccepted = getBoolean("onlyAccepted", true);
var completeMonths = getBoolean("completeMonths", true);

function showObject(o) {
    var s = "";
    for (var key in o) {
        s += key + " " + o[key] + "\n";
    }
    alert(s);
}

function update() {
    setInt("chartType", chartType);
    setInt("statType", statType);
    setBoolean("onlyAccepted", onlyAccepted);
    setBoolean("completeMonths", completeMonths);
    var a = "";
    if (onlyAccepted) {
        a = "accepted-";
    } else {
        a = "all-";
    }
    var b = "";
    if (statType === UNIQUE_USER_PROBLEM) {
        b = "unique-user-problem";
    } else if (statType === ATTEMPTS) {
        b = "attempts";
    } else if (statType === UNIQUE_USERS) {
        b = "unique-users";
    } else {
        throw "неожиданный statType " + statType;
    }
    var c = "";
    if (chartType === RELATIVE) {
        c = "";
    } else if (chartType === ABSOLUTE) {
        c = "-absolute";
    } else if (chartType === ABSOLUTE_LOG) {
        c = "-absolute-log";
    } else {
        throw "неожиданный chartType " + chartType;
    }
    var d = "";
    if (chartType !== RELATIVE || completeMonths) {
        d = "-complete-months";
    }
    var chartPng = a + b + c + d + ".png";
    document.getElementById("chart").src = chartPng;
    document.getElementById("chart_link").setAttribute("href", chartPng);
    if (chartType == RELATIVE) {
        document.getElementById("divCompleteMonths").style.display = "block";
    } else {
        document.getElementById("divCompleteMonths").style.display = "none";
    }
}

</script>
<div>
<label><input type="radio" id="radioChartTypeRelative" name="chartType" onclick="chartType = RELATIVE; update(); return true;"> доли</label>
<label><input type="radio" id="radioChartTypeAbsolute" name="chartType" onclick="chartType = ABSOLUTE; update(); return true;"> количество</label>
<label><input type="radio" id="radioChartTypeAbsoluteLog" name="chartType" onclick="chartType = ABSOLUTE_LOG; update(); return true;"> количество, логарифмическая шкала</label>
</div>
<div>
<label><input type="radio" id="radioStatTypeUserProblem" name="statType" onclick="statType = UNIQUE_USER_PROBLEM; update(); return true;"> уникальные пары пользователь-задача</label>
<label><input type="radio" id="radioStatTypeAttempts" name="statType" onclick="statType = ATTEMPTS; update(); return true;"> попытки</label>
<label><input type="radio" id="radioStatTypeUsers" name="statType" onclick="statType = UNIQUE_USERS; update(); return true;"> уникальные пользователи</label>
</div>
<div>
<label><input type="radio" id="radioOnlyAcceptedTrue" name="onlyAccepted" onclick="onlyAccepted = true; update(); return true;"> учитывать только accepted</label>
<label><input type="radio" id="radioOnlyAcceptedFalse" name="onlyAccepted" onclick="onlyAccepted = false; update(); return true;"> все попытки</label>
</div>
<div id="divCompleteMonths">
<label><input type="radio" id="radioCompleteMonthsTrue" name="completeMonths" onclick="completeMonths = true; update(); return true;"> только полные месяцы</label>
<label><input type="radio" id="radioCompleteMonthsFalse" name="completeMonths" onclick="completeMonths = false; update(); return true;"> включая последний неполный месяц</label>
</div>
<script>

update();

if (chartType === RELATIVE) {
    document.getElementById("radioChartTypeRelative").checked = true;
} else if (chartType === ABSOLUTE) {
    document.getElementById("radioChartTypeAbsolute").checked = true;
} else if (chartType === ABSOLUTE_LOG) {
    document.getElementById("radioChartTypeAbsoluteLog").checked = true;
} else {
    throw "неожиданный chartType " + chartType;
}
if (onlyAccepted) {
    document.getElementById("radioOnlyAcceptedTrue").checked = true;
} else {
    document.getElementById("radioOnlyAcceptedFalse").checked = true;
}
if (statType === UNIQUE_USER_PROBLEM) {
    document.getElementById("radioStatTypeUserProblem").checked = true;
} else if (statType === ATTEMPTS) {
    document.getElementById("radioStatTypeAttempts").checked = true;
} else if (statType === UNIQUE_USERS) {
    document.getElementById("radioStatTypeUsers").checked = true;
} else {
    throw "неожиданный statType " + statType;
}
if (completeMonths) {
    document.getElementById("radioCompleteMonthsTrue").checked = true;
} else {
    document.getElementById("radioCompleteMonthsFalse").checked = true;
}

</script>
<div>
<a href="https://github.com/BorisMenshikov/acmp-langs-data" target="_top">История изменений и исходные данные графиков</a>
</div>
</body>
</html>
